

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frequently Asked Questions (FAQ) &mdash; SUBMARIT 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing Guide" href="contributing.html" />
    <link rel="prev" title="MATLAB to Python Migration Guide" href="migration_guide.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SUBMARIT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Algorithm Theory and Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Tuning Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="migration_guide.html">MATLAB to Python Migration Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frequently Asked Questions (FAQ)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-questions">General Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-submarit">What is SUBMARIT?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-submarit-differ-from-standard-clustering">How does SUBMARIT differ from standard clustering?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-data-do-i-need">What data do I need?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#installation-issues">Installation Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#importerror-no-module-named-submarit">ImportError: No module named ‘submarit’</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cannot-build-wheel-for-numpy-scipy">Cannot build wheel for numpy/scipy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#matlab-engine-not-found">MATLAB Engine not found</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#algorithm-questions">Algorithm Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-do-i-choose-the-number-of-clusters">How do I choose the number of clusters?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-search-doesn-t-converge">Local Search doesn’t converge</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results-are-unstable-between-runs">Results are unstable between runs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance-issues">Performance Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#out-of-memory-with-large-datasets">Out of memory with large datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#slow-computation">Slow computation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-differences">Numerical Differences</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#results-differ-from-matlab-version">Results differ from MATLAB version</a></li>
<li class="toctree-l3"><a class="reference internal" href="#small-numerical-differences-in-results">Small numerical differences in results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#visualization-questions">Visualization Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-to-visualize-high-dimensional-clusters">How to visualize high-dimensional clusters?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-create-publication-quality-plots">How to create publication-quality plots?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-preprocessing">Data Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#feature-engineering">Feature Engineering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#validation-strategy">Validation Strategy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#getting-help">Getting Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#where-to-get-help">Where to get help?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-report-a-bug">How to report a bug?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-contribute">How to contribute?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SUBMARIT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Frequently Asked Questions (FAQ)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/faq.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="frequently-asked-questions-faq">
<h1>Frequently Asked Questions (FAQ)<a class="headerlink" href="#frequently-asked-questions-faq" title="Link to this heading"></a></h1>
<section id="general-questions">
<h2>General Questions<a class="headerlink" href="#general-questions" title="Link to this heading"></a></h2>
<section id="what-is-submarit">
<h3>What is SUBMARIT?<a class="headerlink" href="#what-is-submarit" title="Link to this heading"></a></h3>
<p>SUBMARIT (SUBMARket Identification and Testing) is a Python package for identifying and analyzing submarkets based on product substitution patterns. It helps businesses and researchers understand market structure by clustering products based on how substitutable they are for each other.</p>
</section>
<section id="how-does-submarit-differ-from-standard-clustering">
<h3>How does SUBMARIT differ from standard clustering?<a class="headerlink" href="#how-does-submarit-differ-from-standard-clustering" title="Link to this heading"></a></h3>
<p>While standard clustering groups similar items, SUBMARIT specifically focuses on substitution relationships. Two products might be different in features but highly substitutable (e.g., butter and margarine), which SUBMARIT captures through specialized algorithms and evaluation metrics.</p>
</section>
<section id="what-data-do-i-need">
<h3>What data do I need?<a class="headerlink" href="#what-data-do-i-need" title="Link to this heading"></a></h3>
<p>You need a matrix where:
- Each row represents a product
- Each column represents a feature or attribute
- Values can be numeric (prices, quantities) or encoded categorical data (brand, category)</p>
<p>Example data structure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Products x Features matrix</span>
<span class="c1"># Columns: [price, size, brand_encoded, category_encoded, ...]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">2.99</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>  <span class="c1"># Product 1</span>
    <span class="p">[</span><span class="mf">3.49</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>  <span class="c1"># Product 2</span>
    <span class="o">...</span>
<span class="p">])</span>
</pre></div>
</div>
</section>
</section>
<section id="installation-issues">
<h2>Installation Issues<a class="headerlink" href="#installation-issues" title="Link to this heading"></a></h2>
<section id="importerror-no-module-named-submarit">
<h3>ImportError: No module named ‘submarit’<a class="headerlink" href="#importerror-no-module-named-submarit" title="Link to this heading"></a></h3>
<p><strong>Solution 1:</strong> Ensure you’re in the correct environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check if installed</span>
pip<span class="w"> </span>list<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>submarit

<span class="c1"># If using conda</span>
conda<span class="w"> </span>list<span class="w"> </span>submarit
</pre></div>
</div>
<p><strong>Solution 2:</strong> Reinstall:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>uninstall<span class="w"> </span>submarit
pip<span class="w"> </span>install<span class="w"> </span>submarit
</pre></div>
</div>
</section>
<section id="cannot-build-wheel-for-numpy-scipy">
<h3>Cannot build wheel for numpy/scipy<a class="headerlink" href="#cannot-build-wheel-for-numpy-scipy" title="Link to this heading"></a></h3>
<p><strong>Solution:</strong> Install pre-built wheels:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Windows</span>
pip<span class="w"> </span>install<span class="w"> </span>--only-binary<span class="w"> </span>:all:<span class="w"> </span>numpy<span class="w"> </span>scipy

<span class="c1"># Or use conda</span>
conda<span class="w"> </span>install<span class="w"> </span>numpy<span class="w"> </span>scipy
</pre></div>
</div>
</section>
<section id="matlab-engine-not-found">
<h3>MATLAB Engine not found<a class="headerlink" href="#matlab-engine-not-found" title="Link to this heading"></a></h3>
<p><strong>Solution:</strong> Install MATLAB Engine API for Python:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;C:\Program Files\MATLAB\R2023b\extern\engines\python&quot;</span><span class="w">  </span><span class="c1"># Windows</span>
<span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;/Applications/MATLAB_R2023b.app/extern/engines/python&quot;</span><span class="w">  </span><span class="c1"># macOS</span>
python<span class="w"> </span>setup.py<span class="w"> </span>install
</pre></div>
</div>
</section>
</section>
<section id="algorithm-questions">
<h2>Algorithm Questions<a class="headerlink" href="#algorithm-questions" title="Link to this heading"></a></h2>
<section id="how-do-i-choose-the-number-of-clusters">
<h3>How do I choose the number of clusters?<a class="headerlink" href="#how-do-i-choose-the-number-of-clusters" title="Link to this heading"></a></h3>
<p>Use multiple methods to find optimal k:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.evaluation</span><span class="w"> </span><span class="kn">import</span> <span class="n">gap_statistic</span><span class="p">,</span> <span class="n">elbow_method</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalSearch</span>

<span class="c1"># Method 1: Gap statistic</span>
<span class="n">gaps</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">gap</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">gap_statistic</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n_bootstrap</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">gaps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gap</span><span class="p">)</span>
<span class="n">optimal_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">gaps</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>

<span class="c1"># Method 2: Elbow method</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">):</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">ls</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">objective_</span><span class="p">)</span>

<span class="c1"># Plot and look for &quot;elbow&quot;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">scores</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of clusters&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Within-cluster sum&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="local-search-doesn-t-converge">
<h3>Local Search doesn’t converge<a class="headerlink" href="#local-search-doesn-t-converge" title="Link to this heading"></a></h3>
<p><strong>Solution 1:</strong> Increase iterations and tolerance:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>      <span class="c1"># Increase from default 100</span>
    <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span>          <span class="c1"># Decrease from default 1e-4</span>
    <span class="n">n_restarts</span><span class="o">=</span><span class="mi">20</span>      <span class="c1"># More random restarts</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2:</strong> Check data scale:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize features</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">create_substitution_matrix</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="results-are-unstable-between-runs">
<h3>Results are unstable between runs<a class="headerlink" href="#results-are-unstable-between-runs" title="Link to this heading"></a></h3>
<p><strong>Solution:</strong> Set random seed for reproducibility:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set global seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Or use random_state parameter</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># For complete reproducibility</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># If using parallel processing</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PYTHONHASHSEED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;42&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-issues">
<h2>Performance Issues<a class="headerlink" href="#performance-issues" title="Link to this heading"></a></h2>
<section id="out-of-memory-with-large-datasets">
<h3>Out of memory with large datasets<a class="headerlink" href="#out-of-memory-with-large-datasets" title="Link to this heading"></a></h3>
<p><strong>Solution 1:</strong> Use sparse matrices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_sparse_substitution_matrix</span>

<span class="n">S_sparse</span> <span class="o">=</span> <span class="n">create_sparse_substitution_matrix</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># Keep only top 10% of values</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 2:</strong> Process in chunks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mini-batch processing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiniBatchLocalSearch</span>

<span class="n">mbls</span> <span class="o">=</span> <span class="n">MiniBatchLocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 3:</strong> Use float32 instead of float64:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">create_substitution_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="slow-computation">
<h3>Slow computation<a class="headerlink" href="#slow-computation" title="Link to this heading"></a></h3>
<p><strong>Solution 1:</strong> Enable parallel processing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Use all cores</span>
</pre></div>
</div>
<p><strong>Solution 2:</strong> Use approximate methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApproximateLocalSearch</span>

<span class="n">als</span> <span class="o">=</span> <span class="n">ApproximateLocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">approximation</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span>
    <span class="n">sample_size</span><span class="o">=</span><span class="mi">5000</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Solution 3:</strong> Profile to find bottlenecks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cProfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pstats</span>

<span class="n">profiler</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="n">profiler</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

<span class="c1"># Your code here</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="n">profiler</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="n">profiler</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;cumulative&#39;</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="numerical-differences">
<h2>Numerical Differences<a class="headerlink" href="#numerical-differences" title="Link to this heading"></a></h2>
<section id="results-differ-from-matlab-version">
<h3>Results differ from MATLAB version<a class="headerlink" href="#results-differ-from-matlab-version" title="Link to this heading"></a></h3>
<p>Common causes and solutions:</p>
<ol class="arabic">
<li><p><strong>Different random seeds:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># MATLAB: rng(42)</span>
<span class="c1"># Python:</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Indexing differences (0 vs 1-based):</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># MATLAB: clusters (1-indexed)</span>
<span class="c1"># Python: clusters - 1 (0-indexed)</span>
<span class="n">matlab_clusters</span> <span class="o">=</span> <span class="n">python_clusters</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</li>
<li><p><strong>Numerical precision:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use same tolerance</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>

<span class="c1"># Compare with tolerance</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span>
    <span class="n">python_result</span><span class="p">,</span>
    <span class="n">matlab_result</span><span class="p">,</span>
    <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span>
    <span class="n">atol</span><span class="o">=</span><span class="mf">1e-8</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Algorithm initialization:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure same initialization</span>
<span class="n">init_clusters</span> <span class="o">=</span> <span class="n">load_matlab_initialization</span><span class="p">()</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">init_clusters</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="small-numerical-differences-in-results">
<h3>Small numerical differences in results<a class="headerlink" href="#small-numerical-differences-in-results" title="Link to this heading"></a></h3>
<p>This is normal due to:
- Floating-point arithmetic differences
- Different BLAS/LAPACK implementations
- Compiler optimizations</p>
<p>To minimize differences:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use higher precision</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

<span class="c1"># Disable fast math optimizations</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;MKL_CBWR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;COMPATIBLE&#39;</span>

<span class="c1"># Use same linear algebra backend</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.linalg</span>
<span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">use_solver</span> <span class="o">=</span> <span class="s1">&#39;gesv&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="visualization-questions">
<h2>Visualization Questions<a class="headerlink" href="#visualization-questions" title="Link to this heading"></a></h2>
<section id="how-to-visualize-high-dimensional-clusters">
<h3>How to visualize high-dimensional clusters?<a class="headerlink" href="#how-to-visualize-high-dimensional-clusters" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.decomposition</span><span class="w"> </span><span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.manifold</span><span class="w"> </span><span class="kn">import</span> <span class="n">TSNE</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="c1"># Method 1: PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_2d</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_2d</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_2d</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">clusters</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Clusters in PCA space&#39;</span><span class="p">)</span>

<span class="c1"># Method 2: t-SNE (better for visualization)</span>
<span class="n">tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_tsne</span> <span class="o">=</span> <span class="n">tsne</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">clusters</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Clusters in t-SNE space&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="how-to-create-publication-quality-plots">
<h3>How to create publication-quality plots?<a class="headerlink" href="#how-to-create-publication-quality-plots" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="c1"># Set style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-v0_8-paper&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">&quot;husl&quot;</span><span class="p">)</span>

<span class="c1"># High DPI for publications</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>

<span class="c1"># Create figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="c1"># Plot with proper labels</span>
<span class="n">plot_substitution_matrix</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Product Index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Product Index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Product Substitution Patterns&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Save</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;submarkets.pdf&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<section id="data-preprocessing">
<h3>Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Link to this heading"></a></h3>
<p>Always preprocess your data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Standardize (zero mean, unit variance)</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Or normalize to [0, 1]</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">X_normalized</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Handle missing values</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.impute</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="n">imputer</span> <span class="o">=</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="n">X_complete</span> <span class="o">=</span> <span class="n">imputer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="feature-engineering">
<h3>Feature Engineering<a class="headerlink" href="#feature-engineering" title="Link to this heading"></a></h3>
<p>Create meaningful features:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interaction features</span>
<span class="n">X_interactions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># Price × Size</span>
    <span class="n">X</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>  <span class="c1"># Brand premium</span>
<span class="p">])</span>

<span class="c1"># Polynomial features</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">X_poly</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="validation-strategy">
<h3>Validation Strategy<a class="headerlink" href="#validation-strategy" title="Link to this heading"></a></h3>
<p>Always validate your results:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.validation</span><span class="w"> </span><span class="kn">import</span> <span class="n">cross_validate_clustering</span>

<span class="c1"># Multiple validation methods</span>
<span class="n">validation_results</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;stability&#39;</span><span class="p">:</span> <span class="n">stability_test</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
    <span class="s1">&#39;bootstrap&#39;</span><span class="p">:</span> <span class="n">bootstrap_validation</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
    <span class="s1">&#39;noise&#39;</span><span class="p">:</span> <span class="n">noise_injection_test</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">),</span>
    <span class="s1">&#39;holdout&#39;</span><span class="p">:</span> <span class="n">holdout_validation</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Report</span>
<span class="k">for</span> <span class="n">method</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">validation_results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="getting-help">
<h2>Getting Help<a class="headerlink" href="#getting-help" title="Link to this heading"></a></h2>
<section id="where-to-get-help">
<h3>Where to get help?<a class="headerlink" href="#where-to-get-help" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p><strong>Documentation</strong>: Read the full documentation at <a class="reference external" href="https://submarit.readthedocs.io">https://submarit.readthedocs.io</a></p></li>
<li><p><strong>GitHub Issues</strong>: Report bugs or request features at <a class="reference external" href="https://github.com/yourusername/submarit/issues">https://github.com/yourusername/submarit/issues</a></p></li>
<li><p><strong>Stack Overflow</strong>: Ask questions with tag ‘submarit’</p></li>
<li><p><strong>Email</strong>: Contact maintainers at <a class="reference external" href="mailto:submarit&#37;&#52;&#48;example&#46;com">submarit<span>&#64;</span>example<span>&#46;</span>com</a></p></li>
</ol>
</section>
<section id="how-to-report-a-bug">
<h3>How to report a bug?<a class="headerlink" href="#how-to-report-a-bug" title="Link to this heading"></a></h3>
<p>Include:
1. Minimal reproducible example
2. Full error traceback
3. Environment information:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">submarit</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Python: </span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SUBMARIT: </span><span class="si">{</span><span class="n">submarit</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NumPy: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SciPy: </span><span class="si">{</span><span class="n">scipy</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="how-to-contribute">
<h3>How to contribute?<a class="headerlink" href="#how-to-contribute" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Fork the repository</p></li>
<li><p>Create a feature branch</p></li>
<li><p>Add tests for new functionality</p></li>
<li><p>Submit a pull request</p></li>
</ol>
<p>See <cite>CONTRIBUTING.md</cite> for detailed guidelines.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="migration_guide.html" class="btn btn-neutral float-left" title="MATLAB to Python Migration Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="contributing.html" class="btn btn-neutral float-right" title="Contributing Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, SUBMARIT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>