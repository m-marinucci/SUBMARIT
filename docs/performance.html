

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Performance Tuning Guide &mdash; SUBMARIT 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MATLAB to Python Migration Guide" href="migration_guide.html" />
    <link rel="prev" title="Algorithm Theory and Implementation" href="algorithms.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SUBMARIT
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Algorithm Theory and Implementation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performance Tuning Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dataset-size-guidelines">Dataset Size Guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#memory-optimization">Memory Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sparse-matrices">Sparse Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory-mapped-arrays">Memory-Mapped Arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chunked-processing">Chunked Processing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#speed-optimization">Speed Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parallel-processing">Parallel Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vectorization">Vectorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numba-jit-compilation">Numba JIT Compilation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#algorithm-specific-optimizations">Algorithm-Specific Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#local-search-optimizations">Local Search Optimizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#approximate-methods">Approximate Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#profiling-and-benchmarking">Profiling and Benchmarking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#profile-your-code">Profile Your Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory-profiling">Memory Profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#benchmarking-suite">Benchmarking Suite</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-considerations">Hardware Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cpu-optimization">CPU Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gpu-acceleration">GPU Acceleration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#distributed-computing">Distributed Computing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cloud-deployment">Cloud Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#aws-configuration">AWS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#google-cloud-platform">Google Cloud Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="#azure-ml-pipeline">Azure ML Pipeline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#edge-computing">Edge Computing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lightweight-models">Lightweight Models</a></li>
<li class="toctree-l3"><a class="reference internal" href="#incremental-updates">Incremental Updates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance-monitoring">Performance Monitoring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#real-time-metrics">Real-time Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bottleneck-analysis">Bottleneck Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-optimization-techniques">Advanced Optimization Techniques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jit-compilation-strategies">JIT Compilation Strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#memory-mapping-strategies">Memory Mapping Strategies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#optimization-decision-tree">Optimization Decision Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="#performance-benchmarks">Performance Benchmarks</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="migration_guide.html">MATLAB to Python Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">Frequently Asked Questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing Guide</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SUBMARIT</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Performance Tuning Guide</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/performance.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="performance-tuning-guide">
<h1>Performance Tuning Guide<a class="headerlink" href="#performance-tuning-guide" title="Link to this heading"></a></h1>
<p>This guide helps you optimize SUBMARIT for speed and memory efficiency with large datasets.</p>
<section id="performance-considerations">
<h2>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h2>
<section id="dataset-size-guidelines">
<h3>Dataset Size Guidelines<a class="headerlink" href="#dataset-size-guidelines" title="Link to this heading"></a></h3>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Recommended Approaches by Dataset Size</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 30.0%" />
<col style="width: 30.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Products</p></th>
<th class="head"><p>Memory Required</p></th>
<th class="head"><p>Recommended Approach</p></th>
<th class="head"><p>Expected Time</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&lt; 1,000</p></td>
<td><p>&lt; 1 GB</p></td>
<td><p>Standard dense matrix</p></td>
<td><p>&lt; 1 minute</p></td>
</tr>
<tr class="row-odd"><td><p>1,000 - 10,000</p></td>
<td><p>1-8 GB</p></td>
<td><p>Dense matrix with optimization</p></td>
<td><p>1-10 minutes</p></td>
</tr>
<tr class="row-even"><td><p>10,000 - 100,000</p></td>
<td><p>8-80 GB</p></td>
<td><p>Sparse matrix, mini-batch</p></td>
<td><p>10-60 minutes</p></td>
</tr>
<tr class="row-odd"><td><p>&gt; 100,000</p></td>
<td><p>&gt; 80 GB</p></td>
<td><p>Distributed, approximate methods</p></td>
<td><p>&gt; 1 hour</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="memory-optimization">
<h2>Memory Optimization<a class="headerlink" href="#memory-optimization" title="Link to this heading"></a></h2>
<section id="sparse-matrices">
<h3>Sparse Matrices<a class="headerlink" href="#sparse-matrices" title="Link to this heading"></a></h3>
<p>For datasets with many zero or near-zero substitution values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.sparse</span><span class="w"> </span><span class="kn">import</span> <span class="n">csr_matrix</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_sparse_substitution_matrix</span>

<span class="c1"># Create sparse substitution matrix</span>
<span class="n">S_sparse</span> <span class="o">=</span> <span class="n">create_sparse_substitution_matrix</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># Keep only top 10% of connections</span>
    <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csr&#39;</span>  <span class="c1"># Compressed sparse row format</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Memory usage: </span><span class="si">{</span><span class="n">S_sparse</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">nbytes</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sparsity: </span><span class="si">{</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">S_sparse</span><span class="o">.</span><span class="n">nnz</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">S_sparse</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="memory-mapped-arrays">
<h3>Memory-Mapped Arrays<a class="headerlink" href="#memory-mapped-arrays" title="Link to this heading"></a></h3>
<p>For datasets too large for memory:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_mmap_substitution_matrix</span>

<span class="c1"># Create memory-mapped substitution matrix</span>
<span class="n">S_mmap</span> <span class="o">=</span> <span class="n">create_mmap_substitution_matrix</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;substitution_matrix.dat&#39;</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>  <span class="c1"># Use float32 to save space</span>
    <span class="n">chunks</span><span class="o">=</span><span class="mi">1000</span>  <span class="c1"># Process in chunks</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="chunked-processing">
<h3>Chunked Processing<a class="headerlink" href="#chunked-processing" title="Link to this heading"></a></h3>
<p>Process large matrices in chunks:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">chunked_substitution_matrix</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_in_chunks</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">):</span>
            <span class="n">chunk_i</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span>
            <span class="n">chunk_j</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span>
            <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="n">chunk_size</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_chunk</span><span class="p">(</span><span class="n">chunk_i</span><span class="p">,</span> <span class="n">chunk_j</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">S</span>
</pre></div>
</div>
</section>
</section>
<section id="speed-optimization">
<h2>Speed Optimization<a class="headerlink" href="#speed-optimization" title="Link to this heading"></a></h2>
<section id="parallel-processing">
<h3>Parallel Processing<a class="headerlink" href="#parallel-processing" title="Link to this heading"></a></h3>
<p>Leverage multiple CPU cores:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalSearch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">joblib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span>

<span class="c1"># Use all available cores</span>
<span class="n">n_cores</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span>

<span class="c1"># Parallel clustering with different random seeds</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">n_restarts</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_cores</span>  <span class="c1"># Parallel restarts</span>
<span class="p">)</span>

<span class="c1"># Parallel substitution matrix computation</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">parallel_substitution_matrix</span>

<span class="n">S</span> <span class="o">=</span> <span class="n">parallel_substitution_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_cores</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="vectorization">
<h3>Vectorization<a class="headerlink" href="#vectorization" title="Link to this heading"></a></h3>
<p>Use NumPy’s vectorized operations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Slow: Python loops</span>
<span class="k">def</span><span class="w"> </span><span class="nf">slow_distance</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">D</span>

<span class="c1"># Fast: Vectorized</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fast_distance</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="c1"># Use broadcasting</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Faster: Use scipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial.distance</span><span class="w"> </span><span class="kn">import</span> <span class="n">cdist</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">cdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="numba-jit-compilation">
<h3>Numba JIT Compilation<a class="headerlink" href="#numba-jit-compilation" title="Link to this heading"></a></h3>
<p>Speed up custom functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numba</span><span class="w"> </span><span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">prange</span>

<span class="nd">@jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">fast_local_search_update</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
    <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">while</span> <span class="n">changed</span><span class="p">:</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Parallel loop</span>
            <span class="n">best_cluster</span> <span class="o">=</span> <span class="n">clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">best_cost</span> <span class="o">=</span> <span class="n">compute_cost</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">best_cluster</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_clusters</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">!=</span> <span class="n">clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">cost</span> <span class="o">=</span> <span class="n">compute_cost</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cost</span> <span class="o">&lt;</span> <span class="n">best_cost</span><span class="p">:</span>
                        <span class="n">best_cost</span> <span class="o">=</span> <span class="n">cost</span>
                        <span class="n">best_cluster</span> <span class="o">=</span> <span class="n">k</span>

            <span class="k">if</span> <span class="n">best_cluster</span> <span class="o">!=</span> <span class="n">clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">clusters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">best_cluster</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">clusters</span>
</pre></div>
</div>
</section>
</section>
<section id="algorithm-specific-optimizations">
<h2>Algorithm-Specific Optimizations<a class="headerlink" href="#algorithm-specific-optimizations" title="Link to this heading"></a></h2>
<section id="local-search-optimizations">
<h3>Local Search Optimizations<a class="headerlink" href="#local-search-optimizations" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">OptimizedLocalSearch</span>

<span class="c1"># Use optimized implementation</span>
<span class="n">ols</span> <span class="o">=</span> <span class="n">OptimizedLocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span>
    <span class="n">early_stopping</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Stop when improvement is minimal</span>
    <span class="n">cache_distances</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># Cache frequently accessed distances</span>
    <span class="n">use_triangle_inequality</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Skip unnecessary distance calculations</span>
<span class="p">)</span>

<span class="c1"># Mini-batch version for large datasets</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">MiniBatchLocalSearch</span>

<span class="n">mbls</span> <span class="o">=</span> <span class="n">MiniBatchLocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">n_init</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">max_no_improvement</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="approximate-methods">
<h3>Approximate Methods<a class="headerlink" href="#approximate-methods" title="Link to this heading"></a></h3>
<p>For very large datasets, use approximations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApproximateLocalSearch</span>

<span class="c1"># Use locality-sensitive hashing</span>
<span class="n">als</span> <span class="o">=</span> <span class="n">ApproximateLocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">approximation</span><span class="o">=</span><span class="s1">&#39;lsh&#39;</span><span class="p">,</span>
    <span class="n">n_hash_functions</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">accuracy</span><span class="o">=</span><span class="mf">0.9</span>  <span class="c1"># 90% accuracy vs exact method</span>
<span class="p">)</span>

<span class="c1"># Use random sampling</span>
<span class="n">als_sample</span> <span class="o">=</span> <span class="n">ApproximateLocalSearch</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">approximation</span><span class="o">=</span><span class="s1">&#39;sample&#39;</span><span class="p">,</span>
    <span class="n">sample_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>  <span class="c1"># Work with subset</span>
    <span class="n">n_iterations</span><span class="o">=</span><span class="mi">5</span>  <span class="c1"># Refine with full data</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="profiling-and-benchmarking">
<h2>Profiling and Benchmarking<a class="headerlink" href="#profiling-and-benchmarking" title="Link to this heading"></a></h2>
<section id="profile-your-code">
<h3>Profile Your Code<a class="headerlink" href="#profile-your-code" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cProfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pstats</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">Timer</span>

<span class="c1"># Simple timing</span>
<span class="k">with</span> <span class="n">Timer</span><span class="p">()</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">create_substitution_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Matrix creation took </span><span class="si">{</span><span class="n">t</span><span class="o">.</span><span class="n">elapsed</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="c1"># Detailed profiling</span>
<span class="n">profiler</span> <span class="o">=</span> <span class="n">cProfile</span><span class="o">.</span><span class="n">Profile</span><span class="p">()</span>
<span class="n">profiler</span><span class="o">.</span><span class="n">enable</span><span class="p">()</span>

<span class="n">clusters</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="n">profiler</span><span class="o">.</span><span class="n">disable</span><span class="p">()</span>
<span class="n">stats</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="n">profiler</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="s1">&#39;cumulative&#39;</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Top 10 time-consuming functions</span>
</pre></div>
</div>
</section>
<section id="memory-profiling">
<h3>Memory Profiling<a class="headerlink" href="#memory-profiling" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">memory_profiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">profile</span>

<span class="nd">@profile</span>
<span class="k">def</span><span class="w"> </span><span class="nf">memory_intensive_function</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">create_substitution_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">ls</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">clusters</span> <span class="o">=</span> <span class="n">ls</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">clusters</span>

<span class="c1"># Run with: python -m memory_profiler your_script.py</span>
</pre></div>
</div>
</section>
<section id="benchmarking-suite">
<h3>Benchmarking Suite<a class="headerlink" href="#benchmarking-suite" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.benchmarks</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_benchmark</span>

<span class="c1"># Benchmark different configurations</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">run_benchmark</span><span class="p">(</span>
    <span class="n">dataset_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">],</span>
    <span class="n">n_clusters_list</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
    <span class="n">algorithms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;local_search&#39;</span><span class="p">,</span> <span class="s1">&#39;kmeans&#39;</span><span class="p">,</span> <span class="s1">&#39;hierarchical&#39;</span><span class="p">],</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;memory&#39;</span><span class="p">,</span> <span class="s1">&#39;quality&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Plot results</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.benchmarks</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_benchmark_results</span>
<span class="n">plot_benchmark_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices">
<h2>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading"></a></h2>
<ol class="arabic">
<li><p><strong>Data Preprocessing</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize features for faster convergence</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="n">X_scaled</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1"># Remove redundant features</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">VarianceThreshold</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">X_reduced</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_scaled</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Caching Results</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">joblib</span>

<span class="c1"># Cache substitution matrix</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;substitution_matrix.pkl&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">create_substitution_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="s1">&#39;substitution_matrix.pkl&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Progressive Refinement</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start with coarse clustering, then refine</span>
<span class="k">def</span><span class="w"> </span><span class="nf">progressive_clustering</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">final_k</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="c1"># Stage 1: Coarse clustering</span>
    <span class="n">coarse_k</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">coarse_clusters</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">coarse_k</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># Stage 2: Refine each coarse cluster</span>
    <span class="n">final_clusters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coarse_k</span><span class="p">):</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">coarse_clusters</span> <span class="o">==</span> <span class="n">i</span>
        <span class="n">X_subset</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_subset</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">final_k</span> <span class="o">//</span> <span class="n">coarse_k</span><span class="p">:</span>
            <span class="n">sub_k</span> <span class="o">=</span> <span class="n">final_k</span> <span class="o">//</span> <span class="n">coarse_k</span>
            <span class="n">sub_clusters</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">sub_k</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X_subset</span><span class="p">)</span>
            <span class="n">final_clusters</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">sub_clusters</span> <span class="o">+</span> <span class="n">offset</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">sub_k</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">final_clusters</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">offset</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">final_clusters</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="hardware-considerations">
<h2>Hardware Considerations<a class="headerlink" href="#hardware-considerations" title="Link to this heading"></a></h2>
<section id="cpu-optimization">
<h3>CPU Optimization<a class="headerlink" href="#cpu-optimization" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Use Intel MKL for optimized linear algebra: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">mkl</span></code></p></li>
<li><p>Set thread affinity: <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">OMP_NUM_THREADS=8</span></code></p></li>
<li><p>Disable hyperthreading for compute-intensive tasks</p></li>
</ul>
</section>
<section id="gpu-acceleration">
<h3>GPU Acceleration<a class="headerlink" href="#gpu-acceleration" title="Link to this heading"></a></h3>
<p>For extremely large datasets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using CuPy for GPU arrays</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gpu_distance_matrix</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">X_gpu</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="c1"># Compute pairwise distances on GPU</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">X_gpu</span><span class="p">[:,</span> <span class="n">cp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">X_gpu</span><span class="p">[</span><span class="n">cp</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
    <span class="n">distances</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>  <span class="c1"># Transfer back to CPU</span>
</pre></div>
</div>
</section>
<section id="distributed-computing">
<h3>Distributed Computing<a class="headerlink" href="#distributed-computing" title="Link to this heading"></a></h3>
<p>For cluster computing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dask.distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">Client</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dask.array</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">da</span>

<span class="c1"># Setup Dask client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="s1">&#39;scheduler-address:8786&#39;</span><span class="p">)</span>

<span class="c1"># Convert to Dask array</span>
<span class="n">X_dask</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Compute in parallel across cluster</span>
<span class="n">S_dask</span> <span class="o">=</span> <span class="n">compute_distributed_substitution_matrix</span><span class="p">(</span><span class="n">X_dask</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">S_dask</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>  <span class="c1"># Trigger computation</span>
</pre></div>
</div>
</section>
</section>
<section id="cloud-deployment">
<h2>Cloud Deployment<a class="headerlink" href="#cloud-deployment" title="Link to this heading"></a></h2>
<section id="aws-configuration">
<h3>AWS Configuration<a class="headerlink" href="#aws-configuration" title="Link to this heading"></a></h3>
<p>Deploy SUBMARIT on AWS for large-scale processing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using AWS Batch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">boto3</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">AWSBatchRunner</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">AWSBatchRunner</span><span class="p">(</span>
    <span class="n">job_definition</span><span class="o">=</span><span class="s1">&#39;submarit-clustering&#39;</span><span class="p">,</span>
    <span class="n">job_queue</span><span class="o">=</span><span class="s1">&#39;high-memory-queue&#39;</span><span class="p">,</span>
    <span class="n">vcpus</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">memory</span><span class="o">=</span><span class="mi">64000</span>  <span class="c1"># 64GB</span>
<span class="p">)</span>

<span class="c1"># Submit job</span>
<span class="n">job_id</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span>
    <span class="n">data_s3_path</span><span class="o">=</span><span class="s1">&#39;s3://bucket/data.csv&#39;</span><span class="p">,</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;local_search&#39;</span>
<span class="p">)</span>

<span class="c1"># Monitor progress</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">get_status</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="google-cloud-platform">
<h3>Google Cloud Platform<a class="headerlink" href="#google-cloud-platform" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">GCPDataprocRunner</span>

<span class="n">runner</span> <span class="o">=</span> <span class="n">GCPDataprocRunner</span><span class="p">(</span>
    <span class="n">cluster_name</span><span class="o">=</span><span class="s1">&#39;submarit-cluster&#39;</span><span class="p">,</span>
    <span class="n">num_workers</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">worker_machine_type</span><span class="o">=</span><span class="s1">&#39;n1-highmem-8&#39;</span>
<span class="p">)</span>

<span class="c1"># Run distributed clustering</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">run_clustering</span><span class="p">(</span>
    <span class="n">gcs_path</span><span class="o">=</span><span class="s1">&#39;gs://bucket/data.csv&#39;</span><span class="p">,</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="azure-ml-pipeline">
<h3>Azure ML Pipeline<a class="headerlink" href="#azure-ml-pipeline" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">azureml.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Workspace</span><span class="p">,</span> <span class="n">Experiment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.cloud</span><span class="w"> </span><span class="kn">import</span> <span class="n">AzureMLRunner</span>

<span class="c1"># Configure compute</span>
<span class="n">runner</span> <span class="o">=</span> <span class="n">AzureMLRunner</span><span class="p">(</span>
    <span class="n">workspace</span><span class="o">=</span><span class="n">ws</span><span class="p">,</span>
    <span class="n">compute_target</span><span class="o">=</span><span class="s1">&#39;gpu-cluster&#39;</span><span class="p">,</span>
    <span class="n">environment</span><span class="o">=</span><span class="s1">&#39;submarit-env&#39;</span>
<span class="p">)</span>

<span class="c1"># Run experiment</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">runner</span><span class="o">.</span><span class="n">submit_experiment</span><span class="p">(</span>
    <span class="n">data_path</span><span class="o">=</span><span class="s1">&#39;datastore://products/data.csv&#39;</span><span class="p">,</span>
    <span class="n">config</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;n_clusters&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
        <span class="s1">&#39;algorithm&#39;</span><span class="p">:</span> <span class="s1">&#39;gpu_local_search&#39;</span><span class="p">,</span>
        <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">10000</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="edge-computing">
<h2>Edge Computing<a class="headerlink" href="#edge-computing" title="Link to this heading"></a></h2>
<p>For real-time submarket analysis at retail locations:</p>
<section id="lightweight-models">
<h3>Lightweight Models<a class="headerlink" href="#lightweight-models" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.edge</span><span class="w"> </span><span class="kn">import</span> <span class="n">EdgeClusterer</span>

<span class="c1"># Create lightweight model</span>
<span class="n">edge_model</span> <span class="o">=</span> <span class="n">EdgeClusterer</span><span class="p">(</span>
    <span class="n">n_clusters</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">max_products</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">memory_limit</span><span class="o">=</span><span class="s1">&#39;512MB&#39;</span><span class="p">,</span>
    <span class="n">cpu_limit</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># Export for edge deployment</span>
<span class="n">edge_model</span><span class="o">.</span><span class="n">export_onnx</span><span class="p">(</span><span class="s1">&#39;edge_model.onnx&#39;</span><span class="p">)</span>
<span class="n">edge_model</span><span class="o">.</span><span class="n">export_tflite</span><span class="p">(</span><span class="s1">&#39;edge_model.tflite&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="incremental-updates">
<h3>Incremental Updates<a class="headerlink" href="#incremental-updates" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Edge device code</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.edge</span><span class="w"> </span><span class="kn">import</span> <span class="n">IncrementalEdgeClusterer</span>

<span class="n">clusterer</span> <span class="o">=</span> <span class="n">IncrementalEdgeClusterer</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;edge_model.pkl&#39;</span><span class="p">)</span>

<span class="c1"># Process new products in real-time</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">new_products</span> <span class="o">=</span> <span class="n">get_new_products</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">new_products</span><span class="p">:</span>
        <span class="n">clusterer</span><span class="o">.</span><span class="n">partial_update</span><span class="p">(</span><span class="n">new_products</span><span class="p">)</span>

    <span class="c1"># Periodic sync with cloud</span>
    <span class="k">if</span> <span class="n">time_to_sync</span><span class="p">():</span>
        <span class="n">clusterer</span><span class="o">.</span><span class="n">sync_with_cloud</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-monitoring">
<h2>Performance Monitoring<a class="headerlink" href="#performance-monitoring" title="Link to this heading"></a></h2>
<section id="real-time-metrics">
<h3>Real-time Metrics<a class="headerlink" href="#real-time-metrics" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.monitoring</span><span class="w"> </span><span class="kn">import</span> <span class="n">PerformanceMonitor</span>

<span class="n">monitor</span> <span class="o">=</span> <span class="n">PerformanceMonitor</span><span class="p">(</span>
    <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="s1">&#39;memory&#39;</span><span class="p">,</span> <span class="s1">&#39;disk&#39;</span><span class="p">,</span> <span class="s1">&#39;network&#39;</span><span class="p">],</span>
    <span class="n">interval</span><span class="o">=</span><span class="mf">1.0</span>  <span class="c1"># seconds</span>
<span class="p">)</span>

<span class="k">with</span> <span class="n">monitor</span><span class="p">:</span>
    <span class="n">clusters</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>

<span class="c1"># Get performance report</span>
<span class="n">report</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">get_report</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak memory: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;memory_peak_mb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;CPU time: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;cpu_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Wall time: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;wall_time&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="bottleneck-analysis">
<h3>Bottleneck Analysis<a class="headerlink" href="#bottleneck-analysis" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.profiling</span><span class="w"> </span><span class="kn">import</span> <span class="n">bottleneck_analysis</span>

<span class="c1"># Automatic bottleneck detection</span>
<span class="n">analysis</span> <span class="o">=</span> <span class="n">bottleneck_analysis</span><span class="p">(</span>
    <span class="n">function</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">S</span><span class="p">),</span>
    <span class="n">data_size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">S</span><span class="p">),</span>
    <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bottlenecks found:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bottleneck</span> <span class="ow">in</span> <span class="n">analysis</span><span class="p">[</span><span class="s1">&#39;bottlenecks&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">bottleneck</span><span class="p">[</span><span class="s1">&#39;function&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">bottleneck</span><span class="p">[</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% of time&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Suggestion: </span><span class="si">{</span><span class="n">bottleneck</span><span class="p">[</span><span class="s1">&#39;optimization_hint&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-optimization-techniques">
<h2>Advanced Optimization Techniques<a class="headerlink" href="#advanced-optimization-techniques" title="Link to this heading"></a></h2>
<section id="jit-compilation-strategies">
<h3>JIT Compilation Strategies<a class="headerlink" href="#jit-compilation-strategies" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numba</span><span class="w"> </span><span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">cuda</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">submarit.optimization</span><span class="w"> </span><span class="kn">import</span> <span class="n">auto_optimize</span>

<span class="c1"># Automatic optimization selection</span>
<span class="nd">@auto_optimize</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="s1">&#39;gpu&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">optimized_distance_computation</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="c1"># Framework automatically selects best implementation</span>
    <span class="k">pass</span>

<span class="c1"># GPU-specific optimization</span>
<span class="nd">@cuda</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gpu_local_search_kernel</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">n_clusters</span><span class="p">):</span>
    <span class="c1"># CUDA kernel for GPU execution</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">clusters</span><span class="p">):</span>
        <span class="c1"># Parallel cluster assignment update</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="memory-mapping-strategies">
<h3>Memory Mapping Strategies<a class="headerlink" href="#memory-mapping-strategies" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">submarit.optimization</span><span class="w"> </span><span class="kn">import</span> <span class="n">SmartMemoryManager</span>

<span class="c1"># Intelligent memory management</span>
<span class="n">manager</span> <span class="o">=</span> <span class="n">SmartMemoryManager</span><span class="p">(</span>
    <span class="n">available_memory</span><span class="o">=</span><span class="s1">&#39;16GB&#39;</span><span class="p">,</span>
    <span class="n">swap_path</span><span class="o">=</span><span class="s1">&#39;/fast_ssd/swap&#39;</span><span class="p">,</span>
    <span class="n">compression</span><span class="o">=</span><span class="s1">&#39;lz4&#39;</span>
<span class="p">)</span>

<span class="c1"># Automatically handles large matrices</span>
<span class="k">with</span> <span class="n">manager</span><span class="p">:</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">create_substitution_matrix</span><span class="p">(</span><span class="n">very_large_X</span><span class="p">)</span>
    <span class="n">clusters</span> <span class="o">=</span> <span class="n">LocalSearch</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="optimization-decision-tree">
<h2>Optimization Decision Tree<a class="headerlink" href="#optimization-decision-tree" title="Link to this heading"></a></h2>
<p>Use this decision tree to choose optimization strategies:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Dataset Size?
├── &lt; 1,000 products
│   └── Use default settings
├── 1,000 - 10,000 products
│   ├── Memory &lt; 8GB?
│   │   ├── Yes → Use sparse matrices
│   │   └── No → Use dense matrices with parallel processing
│   └── Time critical?
│       ├── Yes → Use approximate methods
│       └── No → Use exact methods with multiple restarts
└── &gt; 10,000 products
    ├── Memory &lt; 32GB?
    │   ├── Yes → Use mini-batch or distributed computing
    │   └── No → Use GPU acceleration if available
    └── Real-time requirements?
        ├── Yes → Use edge computing with incremental updates
        └── No → Use cloud computing with batch processing
</pre></div>
</div>
</section>
<section id="performance-benchmarks">
<h2>Performance Benchmarks<a class="headerlink" href="#performance-benchmarks" title="Link to this heading"></a></h2>
<p>Latest benchmark results (v2.0):</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Performance Benchmarks</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset Size</p></th>
<th class="head"><p>Algorithm</p></th>
<th class="head"><p>Time (seconds)</p></th>
<th class="head"><p>Memory (GB)</p></th>
<th class="head"><p>Hardware</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1,000</p></td>
<td><p>Local Search</p></td>
<td><p>0.5</p></td>
<td><p>0.1</p></td>
<td><p>4-core CPU</p></td>
</tr>
<tr class="row-odd"><td><p>10,000</p></td>
<td><p>Local Search</p></td>
<td><p>45</p></td>
<td><p>8</p></td>
<td><p>8-core CPU</p></td>
</tr>
<tr class="row-even"><td><p>10,000</p></td>
<td><p>GPU Local Search</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p>NVIDIA V100</p></td>
</tr>
<tr class="row-odd"><td><p>100,000</p></td>
<td><p>Mini-batch LS</p></td>
<td><p>600</p></td>
<td><p>16</p></td>
<td><p>16-core CPU</p></td>
</tr>
<tr class="row-even"><td><p>100,000</p></td>
<td><p>Distributed LS</p></td>
<td><p>120</p></td>
<td><p>8/node</p></td>
<td><p>10-node cluster</p></td>
</tr>
<tr class="row-odd"><td><p>1,000,000</p></td>
<td><p>Approximate LS</p></td>
<td><p>1800</p></td>
<td><p>32</p></td>
<td><p>32-core CPU</p></td>
</tr>
<tr class="row-even"><td><p>1,000,000</p></td>
<td><p>Cloud GPU</p></td>
<td><p>300</p></td>
<td><p>16</p></td>
<td><p>4x NVIDIA A100</p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="algorithms.html" class="btn btn-neutral float-left" title="Algorithm Theory and Implementation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="migration_guide.html" class="btn btn-neutral float-right" title="MATLAB to Python Migration Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, SUBMARIT Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>